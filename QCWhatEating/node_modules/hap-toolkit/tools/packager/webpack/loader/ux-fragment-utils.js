"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function makeLoaderString(e,a,r){a=a||{};var t=void 0;return e===_utils.FRAG_TYPE.IMPORT?(t=[{name:defaultLoaders.component,query:{type:_utils.FRAG_TYPE.IMPORT}}],(0,_utils.stringifyLoaders)(t)):e===_utils.FRAG_TYPE.TEMPLATE?(t=[{name:defaultLoaders.json},{name:defaultLoaders.template}],a.alone||t.push({name:defaultLoaders.fragment,query:{index:0,type:_utils.FRAG_TYPE.TEMPLATE}}),(0,_utils.stringifyLoaders)(t)):e===_utils.FRAG_TYPE.STYLE?(t=[{name:defaultLoaders.json},{name:defaultLoaders.style,query:{index:0,type:_utils.FRAG_TYPE.STYLE}}],a.lang&&t.push({name:a.lang+"-loader"}),a.alone||t.push({name:defaultLoaders.fragment,query:{index:0,type:_utils.FRAG_TYPE.STYLE}}),(0,_utils.stringifyLoaders)(t)):e===_utils.FRAG_TYPE.SCRIPT?(t=[{name:defaultLoaders.script}],r===_utils.UX_TYPE.APP?t.push({name:defaultLoaders.mainfest,query:{path:a.path}},{name:defaultLoaders.babel,query:{presets:[(0,_utils.loadBabelModule)("babel-preset-env")],plugins:[(0,_utils.loadBabelModule)("babel-plugin-transform-runtime")],comments:"false",babelrc:optionBabelrc}}):(t.push({name:defaultLoaders.babel,query:{presets:[(0,_utils.loadBabelModule)("babel-preset-env")],plugins:[_path2.default.resolve(loaderPath,"jsx-loader.js")],comments:"false",babelrc:optionBabelrc}}),(0,_utils.isUXRender)(r)&&t.push({name:defaultLoaders.access})),a.alone||t.push({name:defaultLoaders.fragment,query:{index:0,type:_utils.FRAG_TYPE.SCRIPT}}),(0,_utils.stringifyLoaders)(t)):void 0}function processImportFrag(e,a,r){var t="";if(a.length)for(var s=0;s<a.length;s++){var l=a[s],o=l.attrs.src,u=l.attrs.name;if(!o)return(0,_utils.logWarn)(e,[{reason:"导入组件需要设置属性 `src` "}]),"";if(!l.isValid)return e.emitError("导入组件resolve 出错 "+l.err),"";o=l.srcPath,u||(u=(0,_utils.getNameByPath)(o)),u=u.toLowerCase(),_validator2.default.isReservedTag(u)&&(0,_utils.logWarn)(e,[{reason:"导入组件的属性 `name` 不能使用保留字: "+u}]),r.push(u),(0,_utils.print)({name:u,src:o});var i=(0,_utils.makeRequireString)(e,makeLoaderString(_utils.FRAG_TYPE.IMPORT),o+"?uxType="+_utils.UX_TYPE.COMP+"&name="+u);t+=i}return t}function processTemplateFrag(e,a,r){var t="";if(a.length){var s=a[0],l=e.resourcePath,o=s.attrs.src;o&&(l=o),t="var $app_template$ = "+(0,_utils.makeRequireString)(e,makeLoaderString(_utils.FRAG_TYPE.TEMPLATE,{alone:!!o}),l+"?uxType="+r)}else(0,_utils.logWarn)(e,[{reason:"需要模板片段"}]);return t}function processStyleFrag(e,a,r){var t="";if(a.length){var s=a[0],l=e.resourcePath,o=s.attrs.src,u=s.attrs.lang;o&&(l=o),(0,_utils.print)({style:l}),t="var $app_style$ = "+(0,_utils.makeRequireString)(e,makeLoaderString(_utils.FRAG_TYPE.STYLE,{alone:!!o,lang:u}),l+"?uxType="+r)}return t}function processScriptFrag(e,a,r){var t="";if(a.length){var s=a[0],l=e.resourcePath,o=s.attrs.src;o&&(l=o),t="var $app_script$ = "+(0,_utils.makeRequireString)(e,makeLoaderString(_utils.FRAG_TYPE.SCRIPT,{alone:!!o,path:e.resourcePath},r),l+"?uxType="+r)}return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.processScriptFrag=exports.processStyleFrag=exports.processTemplateFrag=exports.processImportFrag=void 0;var _path=require("path"),_path2=_interopRequireDefault(_path),_validator=require("../../compiler/template/validator"),_validator2=_interopRequireDefault(_validator),_utils=require("../../common/utils"),loaderPath=__dirname,defaultLoaders={component:_path2.default.resolve(loaderPath,"ux-loader.js"),fragment:_path2.default.resolve(loaderPath,"fragment-loader.js"),template:_path2.default.resolve(loaderPath,"template-loader.js"),style:_path2.default.resolve(loaderPath,"style-loader.js"),script:_path2.default.resolve(loaderPath,"script-loader.js"),babel:(0,_utils.loadBabelModule)("babel-loader"),mainfest:_path2.default.resolve(loaderPath,"manifest-loader.js"),access:_path2.default.resolve(loaderPath,"access-loader.js"),json:_path2.default.resolve(loaderPath,"json-loader.js")},optionBabelrc=process&&process.babelrc;exports.processImportFrag=processImportFrag,exports.processTemplateFrag=processTemplateFrag,exports.processStyleFrag=processStyleFrag,exports.processScriptFrag=processScriptFrag;